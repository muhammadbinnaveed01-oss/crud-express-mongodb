<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>CRUD FORM</title>
</head>
<body>

<h1><b><i><u>CRUD FORM</u></i></b></h1>

<div class="row g-4">
    <!-- create -->
    <div class="col" style="border: 3px solid black; border-radius: 2%;">
        <h2>Create</h2>
        <form id="createform">
            <input id="createname" type="text" placeholder="name" class="form-control mb-2"><br>
            <input id="createrank" type="number" placeholder="rank" class="form-control mb-2"><br>
            <textarea id="createdescription" placeholder="description" class="form-control mb-2"></textarea><br>
            <button type="submit" class="btn btn-success">Create</button><br>
            <button type="button" class="btn btn-primary mt-2" id="readBtn">Read</button>
        </form>
    </div>

    <!-- update -->
    <div class="col" style="border: 3px solid black; border-radius: 2%;">
        <h2>Update</h2>
        <form id="updateform">
            <input id="updateid" type="text" placeholder="id" class="form-control mb-2"><br>
            <input id="updatename" type="text" placeholder="name" class="form-control mb-2"><br>
            <input id="updaterank" type="number" placeholder="rank" class="form-control mb-2"><br>
            <textarea id="updatedescription" placeholder="description" class="form-control mb-2"></textarea><br>
            <button type="submit" class="btn btn-warning">Update</button>
        </form>
    </div>

    <!-- delete -->
    <div class="col" style="border: 3px solid black; border-radius: 2%;">
        <h2>Delete</h2>
        <form id="deleteform">
            <input id="deleteid" type="text" placeholder="id" class="form-control mb-2"><br>
            <button type="submit" class="btn btn-danger">Delete</button>
        </form>
    </div>
</div>

<!-- results -->
<div class="mt-4">
    <h3>ðŸ“‹ Results:</h3>
    <pre id="output" class="bg-light p-3 border"></pre>
</div>

<script>
const output = document.getElementById("output");

// CREATE
document.getElementById("createform").addEventListener("submit", async (e) => {
    e.preventDefault();
    const data = {
        name: document.getElementById("createname").value,
        rank: document.getElementById("createrank").value,
        description: document.getElementById("createdescription").value
    };
    const res = await fetch("/user", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
    });
    output.textContent = JSON.stringify(await res.json(), null, 2);
});

// READ
document.getElementById("readBtn").addEventListener("click", async () => {
    const res = await fetch("/user");
    output.textContent = JSON.stringify(await res.json(), null, 2);
});

// UPDATE
document.getElementById("updateform").addEventListener("submit", async (e) => {
    e.preventDefault();
    const id = document.getElementById("updateid").value;
    const data = {
        name: document.getElementById("updatename").value,
        rank: document.getElementById("updaterank").value,
        description: document.getElementById("updatedescription").value
    };
    const res = await fetch(`/user/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
    });
    output.textContent = JSON.stringify(await res.json(), null, 2);
});

// DELETE
document.getElementById("deleteform").addEventListener("submit", async (e) => {
    e.preventDefault();
    const id = document.getElementById("deleteid").value;
    const res = await fetch(`/user/${id}`, { method: "DELETE" });
    output.textContent = JSON.stringify(await res.json(), null, 2);
});
</script>

</body>
</html>
